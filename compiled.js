(function(){var l;function q(){window.onload=function(){var b=document.getElementById('gol-canvas');b.width=b.height=512;var a=new p(b,1);j(a),o(a)}}function m(c,b){for(var a=new Uint8Array(c.e.b*c.e.a*4|0),d=0,h=b.length;d<h;d=d+1|0){var f=d<<2;a[f]=b[d]^1?0:255,a[f+1|0]=b[d]^1?0:255,a[f+2|0]=b[d]^1?0:255,a[f+3|0]=255}return c.c.front.subset(a,0,0,c.e.b|0,c.e.a|0),c}function n(a){a.h.step.attach(a.c.back),a.c.front.bind(0),a.a.gl.viewport(0,0,a.e.b|0,a.e.a|0),a.d.gol.use().attrib('quad',a.f.quad,2).uniformi('cellGridTexture',0).uniform('cellGridSize',k(a.e)).draw(5,4);var b=a.c.front;a.c.front=a.c.back,a.c.back=b}function j(b){b.a.defaultFramebuffer.bind(),b.c.front.bind(0),b.a.gl.viewport(0,0,b.i.b|0,b.i.a|0),b.d.copy.use().attrib('quad',b.f.quad,2).uniformi('cellGridTexture',0).uniform('canvasSize',k(b.i)).uniform('pageSize',new Float32Array([b.b.width,b.b.height])).draw(5,4)}function o(b){setInterval(function(){n(b),j(b)},60)}function k(b){return new Float32Array([b.b,b.a])}function g(d,b,a){return d[b]=a,
d}function p(b,a){if(this.a=this.d=null,this.f=this.c=null,this.h=this.i=null,this.e=null,this.b=b,this.i=new r(this.b.width,this.b.height),this.e=new r(this.b.width/a|0,this.b.height/a|0),this.a=new Igloo(b),console.log(this.a.defaultFramebuffer),!this.a.gl)throw'TODO(ryan): handle this';var d=this.a.gl;d.disable(2929),this.d=g(g(Object.create(null),'copy',this.a.program('glsl/quad.vert','glsl/copy.frag')),'gol',this.a.program('glsl/quad.vert','glsl/gol.frag')),this.f=g(Object.create(null),'quad',this.a.array(Igloo.QUAD2)),this.c=g(g(Object.create(null),'front',this.a.texture(null,6408,10497,9728).blank(this.e.b|0,this.e.a|0)),'back',this.a.texture(null,6408,10497,9728).blank(this.e.b|0,this.e.a|0)),this.h=g(Object.create(null),'step',this.a.framebuffer());for(var f=new Uint8Array(this.e.b*this.e.a|0),c=0,h=f.length;c<h;c=c+1|0)f[c]=Math.random()<.5?1:0;m(this,f)}function r(b,a){this.b=b,this.a=a}q()})();
